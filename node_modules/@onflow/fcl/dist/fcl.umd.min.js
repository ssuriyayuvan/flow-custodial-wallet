!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@onflow/fcl-core"),require("@onflow/config"),require("@onflow/util-invariant"),require("@onflow/util-uid"),require("@onflow/fcl-wc")):"function"==typeof define&&define.amd?define(["exports","@onflow/fcl-core","@onflow/config","@onflow/util-invariant","@onflow/util-uid","@onflow/fcl-wc"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).onflowFcl={},e.fclCore,e.config,e.utilInvariant,e.utilUid,e.fclWc)}(this,(function(e,t,n,r,o,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var c=i(a);const s="FCL_IFRAME",l="\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n  color-scheme: light;\n";function u(e){r.invariant(!document.getElementById(s),"Attempt at triggering multiple Frames",{src:e});const t=document.createElement("iframe");t.src=e,t.id=s,t.allow="usb *; hid *",t.frameBorder="0",t.style.cssText=l,document.body.append(t);return[t.contentWindow,()=>{document.getElementById(s)&&document.getElementById(s).remove()}]}const d="FCL_POP";let p=null,f=null;function g(e){null==p||p?.closed?p=function(e,t,n,r,o){const a=n.top.outerHeight/2+n.top.screenY-o/2,i=n.top.outerWidth/2+n.top.screenX-r/2,c=n.open(e,t,`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${r}, height=${o}, top=${a}, left=${i}`);if(!c)throw new Error("Popup failed to open (was it blocked by a popup blocker?)");return c}(e,d,window,640,770):f!==e?(p.location.replace(e),p.focus()):p.focus(),f=e;return[p,()=>{p&&!p.closed&&p.close(),p=null}]}let b=null,y=null;function E(e){if(null==b||b?.closed){if(b=window.open(e,"_blank"),!b)throw new Error("Tab failed to open (was it blocked by the browser?)")}else y!==e?(b.location.replace(e),b.focus()):b.focus();y=e;return[b,()=>{b&&!b.closed&&b.close(),b=null}]}const m=()=>{try{return{can:!("undefined"==typeof window),get:async e=>JSON.parse(sessionStorage.getItem(e)),put:async(e,t)=>sessionStorage.setItem(e,JSON.stringify(t))}}catch(e){return null}},P=()=>{};const R="1.11.0";const h=()=>{};const O=()=>{};const w=()=>{};const j=()=>{throw new Error("Strategy util has not been implemented on this platform")},v={"VIEW/IFRAME":u,"VIEW/POP":g,"VIEW/TAB":E,"VIEW/MOBILE_BROWSER":j,"VIEW/DEEPLINK":j};async function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{serviceEndpoint:()=>{}};const{serviceEndpoint:n}=t;try{return v[e.method](n(e),t)}catch(n){throw console.error("execLocal({service, opts = {}})",n,{service:e,opts:t}),n}}const C={[t.CORE_STRATEGIES["HTTP/RPC"]]:t.getExecHttpPost(I),[t.CORE_STRATEGIES["HTTP/POST"]]:t.getExecHttpPost(I),[t.CORE_STRATEGIES["IFRAME/RPC"]]:function(e){let{service:n,body:r,config:a,opts:i}=e;return new Promise(((e,c)=>{const s=o.uid(),l=i.includeOlderJsonRpcCall;!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:P,close:P};const r=n.onClose||P,o=n.onMessage||P,a=n.onReady||P,i=n.onResponse||P,c=t.buildMessageHandler({close:d,send:p,onReady:a,onResponse:i,onMessage:o});window.addEventListener("message",c);const[s,l]=u(t.serviceEndpoint(e));return{send:p,close:d};function d(){try{window.removeEventListener("message",c),l(),r()}catch(e){console.error("Frame Close Error",e)}}function p(e){try{s.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Frame Send Error",e,t)}}}(n,{async onReady(e,t){let{send:o}=t;try{o({type:"FCL:VIEW:READY:RESPONSE",fclVersion:R,body:r,service:{params:n.params,data:n.data,type:n.type},config:a}),o({fclVersion:R,type:"FCL:FRAME:READY:RESPONSE",body:r,service:{params:n.params,data:n.data,type:n.type},config:a,deprecated:{message:"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),l&&o({jsonrpc:"2.0",id:s,method:"fcl:sign",params:[r,n.params],deprecated:{message:"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}})}catch(e){throw e}},onResponse(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;const r=t.normalizePollingResponse(n.data);switch(r.status){case"APPROVED":e(r.data),o();break;case"DECLINED":c(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:c("Declined: No reason supplied"),o()}}catch(e){throw console.error("execIframeRPC onResponse error",e),e}},onMessage(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;if("2.0"!==n.data.jsonrpc)return;if(n.data.id!==s)return;const r=t.normalizePollingResponse(n.data.result);switch(r.status){case"APPROVED":e(r.data),o();break;case"DECLINED":c(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:c("Declined: No reason supplied"),o()}}catch(e){throw console.error("execIframeRPC onMessage error",e),e}},onClose(){c("Declined: Externally Halted")}})}))},[t.CORE_STRATEGIES["POP/RPC"]]:function(e){let{service:n,body:r,config:a,opts:i}=e;return new Promise(((e,c)=>{const s=o.uid(),{redir:l,includeOlderJsonRpcCall:u}=i;!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:h,close:h};const r=n.onClose||h,o=n.onMessage||h,a=n.onReady||h,i=n.onResponse||h,c=t.buildMessageHandler({close:d,send:p,onReady:a,onResponse:i,onMessage:o});window.addEventListener("message",c);const[s,l]=g(t.serviceEndpoint(e)),u=setInterval((function(){s&&s.closed&&d()}),500);return{send:p,close:d};function d(){try{window.removeEventListener("message",c),clearInterval(u),l(),r()}catch(e){console.error("Popup Close Error",e)}}function p(e){try{s.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Popup Send Error",e,t)}}}(n,{async onReady(e,t){let{send:o}=t;try{o({fclVersion:R,type:"FCL:VIEW:READY:RESPONSE",body:r,service:{params:n.params,data:n.data,type:n.type},config:a}),o({fclVersion:R,type:"FCL:FRAME:READY:RESPONSE",body:r,service:{params:n.params,data:n.data,type:n.type},config:a,deprecated:{message:"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),u&&o({jsonrpc:"2.0",id:s,method:"fcl:sign",params:[r,n.params]})}catch(e){throw e}},onResponse(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;const r=t.normalizePollingResponse(n.data);switch(r.status){case"APPROVED":e(r.data),!l&&o();break;case"DECLINED":c(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:c("Declined: No reason supplied"),o()}}catch(e){throw console.error("execPopRPC onResponse error",e),e}},onMessage(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;if("2.0"!==n.data.jsonrpc)return;if(n.data.id!==s)return;const r=t.normalizePollingResponse(n.data.result);switch(r.status){case"APPROVED":e(r.data),!l&&o();break;case"DECLINED":c(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:c("Declined: No reason supplied"),o()}}catch(e){throw console.error("execPopRPC onMessage error",e),e}},onClose(){c("Declined: Externally Halted")}})}))},[t.CORE_STRATEGIES["TAB/RPC"]]:function(e){let{service:n,body:r,config:a,opts:i}=e;return new Promise(((e,c)=>{const s=o.uid(),{redir:l,includeOlderJsonRpcCall:u}=i;!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:O,close:O};const r=n.onClose||O,o=n.onMessage||O,a=n.onReady||O,i=n.onResponse||O,c=t.buildMessageHandler({close:d,send:p,onReady:a,onResponse:i,onMessage:o});window.addEventListener("message",c);const[s,l]=E(t.serviceEndpoint(e)),u=setInterval((function(){s&&s.closed&&d()}),500);return{send:p,close:d};function d(){try{window.removeEventListener("message",c),clearInterval(u),l(),r()}catch(e){console.error("Tab Close Error",e)}}function p(e){try{s.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Tab Send Error",e,t)}}}(n,{async onReady(e,t){let{send:o}=t;try{o({fclVersion:R,type:"FCL:VIEW:READY:RESPONSE",body:r,service:{params:n.params,data:n.data,type:n.type},config:a}),o({fclVersion:R,type:"FCL:FRAME:READY:RESPONSE",body:r,service:{params:n.params,data:n.data,type:n.type},config:a,deprecated:{message:"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),u&&o({jsonrpc:"2.0",id:s,method:"fcl:sign",params:[r,n.params]})}catch(e){throw e}},onResponse(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;const r=t.normalizePollingResponse(n.data);switch(r.status){case"APPROVED":e(r.data),!l&&o();break;case"DECLINED":c(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:c("Declined: No reason supplied"),o()}}catch(e){throw console.error("execPopRPC onResponse error",e),e}},onMessage(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;if("2.0"!==n.data.jsonrpc)return;if(n.data.id!==s)return;const r=t.normalizePollingResponse(n.data.result);switch(r.status){case"APPROVED":e(r.data),!l&&o();break;case"DECLINED":c(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:c("Declined: No reason supplied"),o()}}catch(e){throw console.error("execPopRPC onMessage error",e),e}},onClose(){c("Declined: Externally Halted")}})}))},[t.CORE_STRATEGIES["EXT/RPC"]]:function(e){let{service:n,body:r,config:o,opts:a}=e;return new Promise(((e,a)=>{!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:w,close:w};const r=n.onClose||w,o=n.onMessage||w,a=n.onReady||w,i=n.onResponse||w,c=t.buildMessageHandler({close:s,send:l,onReady:a,onResponse:i,onMessage:o});return window.addEventListener("message",c),l({service:e}),{send:l,close:s};function s(){try{window.removeEventListener("message",c),r()}catch(e){console.error("Ext Close Error",e)}}function l(e){try{window&&window.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Ext Send Error",e,t)}}}(n,{async onReady(e,t){let{send:a}=t;try{a({fclVersion:R,type:"FCL:VIEW:READY:RESPONSE",body:r,service:{params:n.params,data:n.data,type:n.type},config:o})}catch(e){throw e}},onResponse(n,r){let{close:o}=r;try{if("object"!=typeof n.data)return;const r=t.normalizePollingResponse(n.data);switch(r.status){case"APPROVED":e(r.data),o();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),o();break;case"REDIRECT":e(r),o();break;default:a("Declined: No reason supplied"),o()}}catch(e){throw console.error("execExtRPC onResponse error",e),e}},onClose(){a("Declined: Externally Halted")}})}))}},S="undefined"==typeof window,D=e=>{const t=e["app.detail.title"],n=e["app.detail.icon"],r=e["app.detail.description"],o=e["app.detail.url"];return{name:t??document.title,description:r??"",url:o??window.location.origin,icons:n?[n]:[]}};const N=t.getMutate({platform:"web"}),A=t.getCurrentUser({platform:"web"}),k=A().authorization;n.config({"discovery.wallet.method.default":"IFRAME/RPC","fcl.storage.default":m()}),t.initServiceRegistry({coreStrategies:C}),function(){if(S)return;let e=null,o=!1;n.config.subscribe((async n=>{const a={"walletconnect.projectId":n["walletconnect.projectId"],"app.detail.title":n["app.detail.title"],"app.detail.icon":n["app.detail.icon"],"app.detail.description":n["app.detail.description"],"app.detail.url":n["app.detail.url"]},i=a["walletconnect.projectId"],s=e;if(e=JSON.stringify(a,null,2),o)return void(s!==e&&console.warn(`FCL WalletConnect Plugin has been already loaded with different configuration. It is not possible to change the configuration after the plugin has been loaded.\n\nPrevious configuration:\n${s}\n\nCurrent configuration:\n${e}`));if(!!!i)return;if(r.invariant(!!i,"FCL Configuration value for 'walletconnect.projectId' is required"),t.pluginRegistry.getPlugins().has(c.SERVICE_PLUGIN_NAME))return o||console.warn("It seems like the FCL WalletConnect plugins has been already loaded manually. This is no longer necessary, please see the documentation for more information."),void(o=!0);o=!0;const{FclWcServicePlugin:l}=c.initLazy({projectId:i,metadata:D(a)});t.pluginRegistry.add([l])}))}(),Object.defineProperty(e,"AppUtils",{enumerable:!0,get:function(){return t.AppUtils}}),Object.defineProperty(e,"InteractionTemplateUtils",{enumerable:!0,get:function(){return t.InteractionTemplateUtils}}),Object.defineProperty(e,"TestUtils",{enumerable:!0,get:function(){return t.TestUtils}}),Object.defineProperty(e,"VERSION",{enumerable:!0,get:function(){return t.VERSION}}),Object.defineProperty(e,"WalletUtils",{enumerable:!0,get:function(){return t.WalletUtils}}),Object.defineProperty(e,"account",{enumerable:!0,get:function(){return t.account}}),Object.defineProperty(e,"arg",{enumerable:!0,get:function(){return t.arg}}),Object.defineProperty(e,"args",{enumerable:!0,get:function(){return t.args}}),Object.defineProperty(e,"atBlockHeight",{enumerable:!0,get:function(){return t.atBlockHeight}}),Object.defineProperty(e,"atBlockId",{enumerable:!0,get:function(){return t.atBlockId}}),Object.defineProperty(e,"authorization",{enumerable:!0,get:function(){return t.authorization}}),Object.defineProperty(e,"authorizations",{enumerable:!0,get:function(){return t.authorizations}}),Object.defineProperty(e,"block",{enumerable:!0,get:function(){return t.block}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(e,"cadence",{enumerable:!0,get:function(){return t.cadence}}),Object.defineProperty(e,"cdc",{enumerable:!0,get:function(){return t.cdc}}),Object.defineProperty(e,"config",{enumerable:!0,get:function(){return t.config}}),Object.defineProperty(e,"createSignableVoucher",{enumerable:!0,get:function(){return t.createSignableVoucher}}),Object.defineProperty(e,"decode",{enumerable:!0,get:function(){return t.decode}}),Object.defineProperty(e,"discovery",{enumerable:!0,get:function(){return t.discovery}}),Object.defineProperty(e,"display",{enumerable:!0,get:function(){return t.display}}),Object.defineProperty(e,"events",{enumerable:!0,get:function(){return t.events}}),Object.defineProperty(e,"getAccount",{enumerable:!0,get:function(){return t.getAccount}}),Object.defineProperty(e,"getBlock",{enumerable:!0,get:function(){return t.getBlock}}),Object.defineProperty(e,"getBlockHeader",{enumerable:!0,get:function(){return t.getBlockHeader}}),Object.defineProperty(e,"getChainId",{enumerable:!0,get:function(){return t.getChainId}}),Object.defineProperty(e,"getCollection",{enumerable:!0,get:function(){return t.getCollection}}),Object.defineProperty(e,"getEvents",{enumerable:!0,get:function(){return t.getEvents}}),Object.defineProperty(e,"getEventsAtBlockHeightRange",{enumerable:!0,get:function(){return t.getEventsAtBlockHeightRange}}),Object.defineProperty(e,"getEventsAtBlockIds",{enumerable:!0,get:function(){return t.getEventsAtBlockIds}}),Object.defineProperty(e,"getNetworkParameters",{enumerable:!0,get:function(){return t.getNetworkParameters}}),Object.defineProperty(e,"getNodeVersionInfo",{enumerable:!0,get:function(){return t.getNodeVersionInfo}}),Object.defineProperty(e,"getTransaction",{enumerable:!0,get:function(){return t.getTransaction}}),Object.defineProperty(e,"getTransactionStatus",{enumerable:!0,get:function(){return t.getTransactionStatus}}),Object.defineProperty(e,"invariant",{enumerable:!0,get:function(){return t.invariant}}),Object.defineProperty(e,"isBad",{enumerable:!0,get:function(){return t.isBad}}),Object.defineProperty(e,"isOk",{enumerable:!0,get:function(){return t.isOk}}),Object.defineProperty(e,"limit",{enumerable:!0,get:function(){return t.limit}}),Object.defineProperty(e,"nodeVersionInfo",{enumerable:!0,get:function(){return t.nodeVersionInfo}}),Object.defineProperty(e,"param",{enumerable:!0,get:function(){return t.param}}),Object.defineProperty(e,"params",{enumerable:!0,get:function(){return t.params}}),Object.defineProperty(e,"payer",{enumerable:!0,get:function(){return t.payer}}),Object.defineProperty(e,"ping",{enumerable:!0,get:function(){return t.ping}}),Object.defineProperty(e,"pipe",{enumerable:!0,get:function(){return t.pipe}}),Object.defineProperty(e,"pluginRegistry",{enumerable:!0,get:function(){return t.pluginRegistry}}),Object.defineProperty(e,"proposer",{enumerable:!0,get:function(){return t.proposer}}),Object.defineProperty(e,"query",{enumerable:!0,get:function(){return t.query}}),Object.defineProperty(e,"ref",{enumerable:!0,get:function(){return t.ref}}),Object.defineProperty(e,"sansPrefix",{enumerable:!0,get:function(){return t.sansPrefix}}),Object.defineProperty(e,"script",{enumerable:!0,get:function(){return t.script}}),Object.defineProperty(e,"send",{enumerable:!0,get:function(){return t.send}}),Object.defineProperty(e,"serialize",{enumerable:!0,get:function(){return t.serialize}}),Object.defineProperty(e,"subscribeEvents",{enumerable:!0,get:function(){return t.subscribeEvents}}),Object.defineProperty(e,"t",{enumerable:!0,get:function(){return t.t}}),Object.defineProperty(e,"transaction",{enumerable:!0,get:function(){return t.transaction}}),Object.defineProperty(e,"tx",{enumerable:!0,get:function(){return t.tx}}),Object.defineProperty(e,"validator",{enumerable:!0,get:function(){return t.validator}}),Object.defineProperty(e,"verifyUserSignatures",{enumerable:!0,get:function(){return t.verifyUserSignatures}}),Object.defineProperty(e,"voucherIntercept",{enumerable:!0,get:function(){return t.voucherIntercept}}),Object.defineProperty(e,"voucherToTxId",{enumerable:!0,get:function(){return t.voucherToTxId}}),Object.defineProperty(e,"why",{enumerable:!0,get:function(){return t.why}}),Object.defineProperty(e,"withPrefix",{enumerable:!0,get:function(){return t.withPrefix}}),e.authenticate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A().authenticate(e)},e.authz=k,e.currentUser=A,e.logIn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A().authenticate(e)},e.mutate=N,e.reauthenticate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A().unauthenticate(),A().authenticate(e)},e.signUp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A().authenticate(e)},e.unauthenticate=()=>A().unauthenticate(),Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=fcl.umd.min.js.map
